<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hack In Paris Challenge 4 &mdash; HIPChall 2016 write-up</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="HIPChall 2016 write-up" href="index.html" />
    <link rel="next" title="Hack In Paris Challenge 5" href="challenge5.html" />
    <link rel="prev" title="Hack In Paris Challenge 3" href="challenge3.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>HIPChall 2016 write-up</span></a></h1>
        <h2 class="heading"><span>Hack In Paris Challenge 4</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="challenge3.html">Hack In Paris Challenge 3</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="challenge5.html">Hack In Paris Challenge 5</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="hack-in-paris-challenge-4">
<h1>Hack In Paris Challenge 4<a class="headerlink" href="#hack-in-paris-challenge-4" title="Permalink to this headline">¶</a></h1>
<p>The challenge began on Friday April, 8th, with a <a class="reference external" href="https://twitter.com/hackinparis/status/718461407596015616">tweet</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Make your dream come true, #HIPChall n°4 is up!
#YubiKeyNeo &amp; 2 #goldenticket for #HIP16
Hack, Love, Share, &amp; enjoy!
https://hackinparis.com/challenge-4.html …
</pre></div>
</div>
<p>The web page given by the tweet contains the following message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Hi !

I have found a strange PDF file that seems to contain some interesting data but I didn&#39;t know how to extract and read them.

Can you help me?

https://hackinparis.com/data/chall2016/step-4/dump.pdf

md5 fac78b48bf9603fd52b2f2156d587f1d
sha1 0a7cc0598b5432f7c387a6b5cf8d73409209bcfd

Please send your conclusions (and the validation flag) to merenwen@hackinparis.com
</pre></div>
</div>
<div class="section" id="a-pdf-file-which-is-also-an-elf-file-and-a-zip-file">
<h2>A PDF file which is also an ELF file and a ZIP file<a class="headerlink" href="#a-pdf-file-which-is-also-an-elf-file-and-a-zip-file" title="Permalink to this headline">¶</a></h2>
<p>The downloaded file is a polyglot file: it is both an ELF file, a PDF file and a ZIP file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ binwalk dump.pdf
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             ELF, 32-bit LSB executable, Intel 80386, version 1 (SYSV)
716           0x2CC           PDF document, version: &quot;1.4&quot;
[...]
842635        0xCDB8B         Zip archive data, encrypted at least v1.0 to extract, compressed size: 57, uncompressed size: 45, name: README.txt
842776        0xCDC18         Zip archive data, encrypted at least v2.0 to extract, compressed size: 14476, uncompressed size: 17920, name: pass.png
857334        0xD14F6         Zip archive data, encrypted at least v1.0 to extract, compressed size: 15269, uncompressed size: 15257, name: a.zip
872915        0xD51D3         End of Zip archive
</pre></div>
</div>
<p>The PDF file contains the hexdump of this image:</p>
<img alt="_images/pdfimg.png" src="_images/pdfimg.png" />
<p>The ZIP file requires a password to be extracted and the ELF file seems to test a password given by its standard input.
Here is an extract of the output of <code class="docutils literal"><span class="pre">objdump</span> <span class="pre">-Mintel</span> <span class="pre">-d</span> <span class="pre">dump.pdf</span></code> with some comments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">80480</span><span class="n">f1</span><span class="p">:</span>    <span class="n">bb</span> <span class="mi">01</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>           <span class="n">mov</span>    <span class="n">ebx</span><span class="p">,</span><span class="mh">0x1</span>
<span class="mi">80480</span><span class="n">f6</span><span class="p">:</span>    <span class="n">b8</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>           <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x3</span>
<span class="mi">80480</span><span class="n">fb</span><span class="p">:</span>    <span class="mi">89</span> <span class="n">e1</span>                    <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">esp</span>
<span class="mi">80480</span><span class="n">fd</span><span class="p">:</span>    <span class="n">ba</span> <span class="mi">64</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>           <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x64</span>
<span class="mi">8048102</span><span class="p">:</span>    <span class="n">cd</span> <span class="mi">80</span>                    <span class="nb">int</span>    <span class="mh">0x80</span>         <span class="c1"># syscall(read, fd=1, buf=esp, count=100)</span>
<span class="mi">8048104</span><span class="p">:</span>    <span class="mi">83</span> <span class="n">f8</span> <span class="mi">0</span><span class="n">c</span>                 <span class="nb">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xc</span>
<span class="mi">8048107</span><span class="p">:</span>    <span class="mi">0</span><span class="n">f</span> <span class="mi">85</span> <span class="mi">8</span><span class="n">a</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>        <span class="n">jne</span>    <span class="mh">0x8048197</span>    <span class="c1"># Read 12 bytes</span>
<span class="mi">804810</span><span class="n">d</span><span class="p">:</span>    <span class="mi">89</span> <span class="n">e2</span>                    <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">esp</span>
<span class="mi">804810</span><span class="n">f</span><span class="p">:</span>    <span class="mi">8</span><span class="n">b</span> <span class="mi">02</span>                    <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">edx</span><span class="p">]</span>
<span class="mi">8048111</span><span class="p">:</span>    <span class="mi">3</span><span class="n">d</span> <span class="mi">46</span> <span class="mi">6</span><span class="n">b</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">70</span>           <span class="nb">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x706f6b46</span>
<span class="mi">8048116</span><span class="p">:</span>    <span class="mi">75</span> <span class="mi">7</span><span class="n">f</span>                    <span class="n">jne</span>    <span class="mh">0x8048197</span>    <span class="c1"># The first ones have to be &quot;Fkop&quot;</span>
<span class="mi">8048118</span><span class="p">:</span>    <span class="mi">83</span> <span class="n">c2</span> <span class="mi">04</span>                 <span class="n">add</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x4</span>
<span class="mi">804811</span><span class="n">b</span><span class="p">:</span>    <span class="mi">8</span><span class="n">b</span> <span class="mi">1</span><span class="n">a</span>                    <span class="n">mov</span>    <span class="n">ebx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">edx</span><span class="p">]</span>
<span class="mi">804811</span><span class="n">d</span><span class="p">:</span>    <span class="mi">31</span> <span class="n">d8</span>                    <span class="n">xor</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ebx</span>
<span class="mi">804811</span><span class="n">f</span><span class="p">:</span>    <span class="mi">3</span><span class="n">d</span> <span class="mi">72</span> <span class="mi">4</span><span class="n">a</span> <span class="mi">00</span> <span class="mi">00</span>           <span class="nb">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x4a72</span>
<span class="mi">8048124</span><span class="p">:</span>    <span class="mi">75</span> <span class="mi">71</span>                    <span class="n">jne</span>    <span class="mh">0x8048197</span>   <span class="c1"># The 4 next ones have to be &quot;4!op&quot;</span>
<span class="mi">8048126</span><span class="p">:</span>    <span class="mi">83</span> <span class="n">c2</span> <span class="mi">04</span>                 <span class="n">add</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x4</span>
<span class="mi">8048129</span><span class="p">:</span>    <span class="mi">8</span><span class="n">b</span> <span class="mi">1</span><span class="n">a</span>                    <span class="n">mov</span>    <span class="n">ebx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">edx</span><span class="p">]</span>
<span class="mi">804812</span><span class="n">b</span><span class="p">:</span>    <span class="mi">31</span> <span class="n">d8</span>                    <span class="n">xor</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ebx</span>
<span class="mi">804812</span><span class="n">d</span><span class="p">:</span>    <span class="mi">3</span><span class="n">d</span> <span class="mi">3</span><span class="n">e</span> <span class="mi">27</span> <span class="mi">39</span> <span class="mi">0</span><span class="n">a</span>           <span class="nb">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xa39273e</span>
<span class="mi">8048132</span><span class="p">:</span>    <span class="mi">75</span> <span class="mi">63</span>                    <span class="n">jne</span>    <span class="mh">0x8048197</span>    <span class="c1"># The 4 next ones have to be &quot;Lm9\n&quot;</span>
</pre></div>
</div>
<p>The password seems to be <code class="docutils literal"><span class="pre">Fkop4!opLm9</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ ./dump.pdf
What&#39;s the pass?
Fkop4!opLm9
Rename the file in chall.zip and use this password.
</pre></div>
</div>
</div>
<div class="section" id="how-to-crack-an-encrypted-message-in-a-corrupted-image">
<h2>How to crack an encrypted message in a corrupted image<a class="headerlink" href="#how-to-crack-an-encrypted-message-in-a-corrupted-image" title="Permalink to this headline">¶</a></h2>
<p>The ZIP archive can then be decrypted.  It contains three files:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">README.txt</span></code>: contains &#8220;The archive password is in the PNG picture.&#8221;</li>
<li><code class="docutils literal"><span class="pre">pass.png</span></code>: an invalid PNG image (it can&#8217;t be opened with a standard image viewer)</li>
<li><code class="docutils literal"><span class="pre">a.zip</span></code>: an encrypted ZIP archive</li>
</ul>
<p>The PNG image is invalid because the CRC field of every chunk is zero.
The CRC checksums can be fixed using a program such as <a class="reference external" href="http://schaik.com/png/pngcsum.html">http://schaik.com/png/pngcsum.html</a> , which allows viewing the image.
It contains the following text:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CGEJDH</span> <span class="n">AGBIBJ</span> <span class="n">AFEGBG</span> <span class="n">BJAFEH</span> <span class="n">EJDHAJ</span> <span class="n">AIEJBI</span> <span class="n">EFBJAH</span>
<span class="n">EHDHAG</span> <span class="n">AJEGCG</span> <span class="n">CGDIAJ</span> <span class="n">AJAIEG</span> <span class="n">BGBGEI</span> <span class="n">BFDICG</span> <span class="n">BIEIDF</span>
<span class="n">AFDIBF</span> <span class="n">AFEFEH</span> <span class="n">AJCIDI</span> <span class="n">AJAJBJ</span> <span class="n">AGDIEH</span> <span class="n">AFDJEH</span> <span class="n">BGBGEF</span>
<span class="n">DIBGDF</span> <span class="n">EIEJEG</span> <span class="n">AFEJCG</span> <span class="n">EJBIBI</span> <span class="n">DICGAF</span> <span class="n">BGEIEJ</span> <span class="n">DFDIDH</span>
<span class="n">AFEFDI</span> <span class="n">CFEHDF</span> <span class="n">AIEHBG</span> <span class="n">DIDGEI</span> <span class="n">AGEHAH</span> <span class="n">EHDHAG</span> <span class="n">EIEJEG</span>
<span class="n">AFEFDI</span> <span class="n">BIEHAG</span> <span class="n">EFAFDF</span> <span class="n">BJAJAJ</span> <span class="n">DJEJBI</span> <span class="n">BFBFEJ</span> <span class="n">DHAFAI</span>
<span class="n">EJBIAG</span> <span class="n">DIAFEI</span> <span class="n">EJEGAJ</span> <span class="n">EFEJEG</span> <span class="n">BGBFDJ</span> <span class="n">BIEHAF</span> <span class="n">DIEHAF</span>
<span class="n">EHDHBG</span> <span class="n">EJDJDI</span> <span class="n">BICGBJ</span> <span class="n">AJDIBG</span> <span class="n">DIAFAF</span> <span class="n">DIBIAJ</span> <span class="n">AFEFDI</span>
<span class="n">DFBJAJ</span> <span class="n">AJDJEJ</span> <span class="n">BIBFEH</span> <span class="n">AJAFDG</span> <span class="n">AFBJDH</span> <span class="n">AJDIEI</span> <span class="n">AJBJDI</span>
<span class="n">EHEJCI</span> <span class="n">AJDFEF</span> <span class="n">DIAJBG</span>
</pre></div>
</div>
<p>The first column only contains letters A, C, D, E, the second one only F, G, H, I, J, the third one B, D, E...
It seems more logical to combine the letters by pairs: the first letter being in {A, B, C, D, E} and the second one in {F, G, H, I, J}.
This looks like an encryption with the Polybius square algorithm, where each letter pair is associated to a character.
As it is a substitution cipher, it may be possible to guess some words... for example &#8220;password&#8221; seems to be <code class="docutils literal"><span class="pre">DF</span> <span class="pre">BJ</span> <span class="pre">AJ</span> <span class="pre">AJ</span> <span class="pre">DJ</span> <span class="pre">EJ</span> <span class="pre">BI</span> <span class="pre">BF</span></code> (which appears 2 times).</p>
<p>This leads to the following substitution array:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>   A? B? C? D? E?
?F  t  d  z  p  h
?G  g  l  c  b  u
?H  v  ?  ?  n  i
?I  f  r  m  e  y
?J  s  a  ?  w  o
</pre></div>
</div>
<p>The message is therefore: &#8220;Congratulations for having successfully decrypted this message. It will help you to correctly open the zip file by giving you the right password. Don&#8217;t forget you should write it in lowercase letters. The password is tbtanseysaeiomsphesl&#8221;.</p>
<p>This gives the password which is needed to decrypt a file named <code class="docutils literal"><span class="pre">chall.bin</span></code> in <code class="docutils literal"><span class="pre">a.zip</span></code> archive.
This file is an ELF program:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ file chall.bin
chall.bin: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked,
interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24,
BuildID[sha1]=88f9eadd2bf8128ca309a8dc627e18c82c2755a3, stripped
</pre></div>
</div>
</div>
<div class="section" id="chall-bin-a-brainfuck-interpreter-in-bytecode">
<h2><code class="docutils literal"><span class="pre">chall.bin</span></code>, a brainfuck interpreter in bytecode<a class="headerlink" href="#chall-bin-a-brainfuck-interpreter-in-bytecode" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">chall.bin</span></code> is an interpreter for a custom bytecode language.
The state of the interpreted program (the &#8220;virtual machine&#8221;) is allocated on the stack of function <code class="docutils literal"><span class="pre">main()</span></code> (at <code class="docutils literal"><span class="pre">.text:400B28</span></code>) and initialized by the function at address <code class="docutils literal"><span class="pre">.text:400D2A</span></code>.
This state has the following structure:</p>
<ul class="simple">
<li>offsets 0x00..0x27: <code class="docutils literal"><span class="pre">int32</span> <span class="pre">regs[10]</span></code>, ten 32-bit integer <em>registers</em></li>
<li>offsets 0x28..0x2b: <code class="docutils literal"><span class="pre">int32</span> <span class="pre">sp</span></code>, the <em>stack pointer</em>, offset of the &#8220;top&#8221; of the stack (which is reverted like x86 CPU)</li>
<li>offsets 0x2c..0x2f: <code class="docutils literal"><span class="pre">int32</span> <span class="pre">ip</span></code>, the <em>instruction pointer</em>, offset of the current instruction in the program</li>
<li>offsets 0x30..0x33: <code class="docutils literal"><span class="pre">int32</span> <span class="pre">sf</span></code>, the <em>sign flag</em></li>
<li>offsets 0x34..0x37: <code class="docutils literal"><span class="pre">int32</span> <span class="pre">zf</span></code>, the <em>zero flag</em></li>
<li>offsets 0x38..0x3b: <code class="docutils literal"><span class="pre">int32</span> <span class="pre">memsize</span></code>, the size of allocated virtual memory (500 000 bytes)</li>
</ul>
<p>There are 16 kinds of instruction, of different sizes.
The first byte tells the operation code of the instruction (4 low bits) and whether its execution depends on the SF flag to be set (bit 5, 0x10) or on the ZF flag (bit 6, 0x20).</p>
<ul class="simple">
<li>If the opcode is between 0 and 9, the instruction is an arithmetic instruction between two operands and is encoded on 10 bytes.</li>
<li>If the opcode is between 10 and 12, the instruction only has one operand and is encoded on 6 bytes.</li>
<li>Otherwise, the opcode is between 12 and 15, has no operand and is encoded on one single byte.</li>
</ul>
<p>When an instruction has an operand, its second byte defines the kind of operand: 1 for an immediate 32-bit value, 2 for a register value and 4 for the value at the address of the given register.</p>
<p>The instructions are (with <code class="docutils literal"><span class="pre">x</span></code> being the first operand and <code class="docutils literal"><span class="pre">y</span></code> the second one):</p>
<ul class="simple">
<li>opcode 0: <code class="docutils literal"><span class="pre">x</span> <span class="pre">|=</span> <span class="pre">y</span></code> (OR)</li>
<li>opcode 1: <code class="docutils literal"><span class="pre">x</span> <span class="pre">^=</span> <span class="pre">y</span></code> (XOR)</li>
<li>opcode 2: <code class="docutils literal"><span class="pre">x</span> <span class="pre">&amp;=</span> <span class="pre">y</span></code> (AND)</li>
<li>opcode 3: <code class="docutils literal"><span class="pre">x</span> <span class="pre">+=</span> <span class="pre">y</span></code> (ADD)</li>
<li>opcode 4: <code class="docutils literal"><span class="pre">x</span> <span class="pre">-=</span> <span class="pre">y</span></code> (SUB)</li>
<li>opcode 5: <code class="docutils literal"><span class="pre">x</span> <span class="pre">*=</span> <span class="pre">y</span></code> (MUL)</li>
<li>opcode 6: <code class="docutils literal"><span class="pre">x</span> <span class="pre">/=</span> <span class="pre">y</span></code> (DIV)</li>
<li>opcode 7: <code class="docutils literal"><span class="pre">x</span> <span class="pre">%=</span> <span class="pre">y</span></code> (MOD)</li>
<li>opcode 8: <code class="docutils literal"><span class="pre">x</span> <span class="pre">&lt;&lt;=</span> <span class="pre">y</span></code> (SHL)</li>
<li>opcode 9: <code class="docutils literal"><span class="pre">x</span> <span class="pre">&gt;&gt;=</span> <span class="pre">y</span></code> (SHR)</li>
<li>opcode A: <code class="docutils literal"><span class="pre">PUSH</span> <span class="pre">x</span></code></li>
<li>opcode B: <code class="docutils literal"><span class="pre">POP</span> <span class="pre">x</span></code></li>
<li>opcode C: <code class="docutils literal"><span class="pre">CALL</span> <span class="pre">x</span></code></li>
<li>opcode D: <code class="docutils literal"><span class="pre">RET</span></code></li>
<li>opcode E: <code class="docutils literal"><span class="pre">READ(fd=r0,</span> <span class="pre">buf=r1,</span> <span class="pre">size=r2)</span></code> and replace <code class="docutils literal"><span class="pre">\n</span></code> with <code class="docutils literal"><span class="pre">0</span></code> on the first byte of the buffer</li>
<li>opcode F: <code class="docutils literal"><span class="pre">WRITE(fd=r0,</span> <span class="pre">buf=r1,</span> <span class="pre">size=r2)</span></code></li>
</ul>
<p>The instructions are read from <code class="docutils literal"><span class="pre">.rodata:402280</span></code> and the memory of the interpreter is initialized with the content of <code class="docutils literal"><span class="pre">.rodata:41A920</span></code>.
The interpreted program decrypt the data using the following algorithm (written in Python 3):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;chall.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">filedata</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">memdata</span> <span class="o">=</span> <span class="n">filedata</span><span class="p">[</span><span class="mh">0x1A920</span><span class="p">:</span><span class="mh">0x1A920</span> <span class="o">+</span> <span class="mi">43850</span><span class="p">]</span>

<span class="n">cleardata</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">memdata</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">memdata</span><span class="p">):</span>
    <span class="n">cleardata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>The decrypted data is interpreted as Brainfuck language (<a class="reference external" href="https://en.wikipedia.org/wiki/Brainfuck">https://en.wikipedia.org/wiki/Brainfuck</a>) with the following character conversion:</p>
<ul class="simple">
<li>0, 1: <code class="docutils literal"><span class="pre">+</span></code> (increment the byte at the data pointer, which is <code class="docutils literal"><span class="pre">r1</span></code>)</li>
<li>2, 3: <code class="docutils literal"><span class="pre">-</span></code> (decrement the byte at the data pointer)</li>
<li>4, 5: <code class="docutils literal"><span class="pre">&lt;</span></code> (decrement the data pointer by one cell, which measures 4 bytes)</li>
<li>6, 7: <code class="docutils literal"><span class="pre">&gt;</span></code> (increment the data pointer by one cell)</li>
<li>8, 9: <code class="docutils literal"><span class="pre">[</span></code> (conditional jump forwards to the matching <code class="docutils literal"><span class="pre">]</span></code> if the byte at the data pointer is zero)</li>
<li>a, b: <code class="docutils literal"><span class="pre">]</span></code> (conditional jump backwards to the matching <code class="docutils literal"><span class="pre">[</span></code> if the byte at the data pointer is not zero)</li>
<li>c, d: <code class="docutils literal"><span class="pre">.</span></code> (write the byte at the data pointer to the standard output)</li>
<li>e, f: <code class="docutils literal"><span class="pre">,</span></code> (read one byte from the standard input into the byte at the data pointer)</li>
<li>space or <code class="docutils literal"><span class="pre">\n</span></code>: exit the program</li>
</ul>
<p>The Brainfuck program is quite simple:</p>
<ul class="simple">
<li>It begins by writing &#8220;What is the magic word ?&#8221;</li>
<li>It then reads the standard input and compare with some values. If the input does not match, it outputs &#8220;Ah ah ah! You didn&#8217;t say the magic word!&#8221; and quits.</li>
<li>If the input is correct, it outputs &#8220;Well done!&#8221;</li>
</ul>
<p>The input which is correct is the key, <strong>HIP{f3a306095ecc4dad3d0056ad7b0c135afd89e3127e279e4f906711bf6357f03c}</strong></p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="challenge3.html">Hack In Paris Challenge 3</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="challenge5.html">Hack In Paris Challenge 5</a>&#160;&#160;»
        </p>

      </div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="challenge5.html" title="Hack In Paris Challenge 5"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="challenge3.html" title="Hack In Paris Challenge 3"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HIPChall 2016 write-up</a> &raquo;</li> 
      </ul>
    </div>
  
    <!-- Original code from http://tholman.com/github-corners/ -->
    <a href="https://github.com/fishilico/hackinparis-2016" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg></a>
    <style>
      .github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}
      @keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}
      @media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}
    </style>
  

    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Nicolas Iooss, beerware license.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>